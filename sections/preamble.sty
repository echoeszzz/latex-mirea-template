\ProvidesPackage{sections/preamble}

\RequirePackage{cmap} % for better searchability in PDF viewers
\RequirePackage{fontspec} % for font selection in XeLaTeX
\RequirePackage{polyglossia} % for language support in XeLaTeX
\setmainlanguage{russian}
\setotherlanguages{english}

\RequirePackage{xltxtra}
\defaultfontfeatures{Ligatures=TeX,Mapping=tex-text}
\RequirePackage[none]{microtype}

\setmainfont{Times New Roman}

\setromanfont{Times New Roman}
\setsansfont{Arial}
\setmonofont{Courier New}

%\RequirePackage[english, russian]{babel}
%\RequirePackage[T2A]{fontspec}
%\RequirePackage[utf8]{inputenc}

\RequirePackage[labelsep=period]{caption}
\captionsetup[figure]{labelsep=endash}

\frenchspacing
\pagestyle{plain}

\RequirePackage[left=3cm, right=1cm, vmargin=2cm]{geometry}
\linespread{1.5} % line spacing 1.5
\RequirePackage{indentfirst} % indent first paragraph
\setlength{\parindent}{1.25cm}
\sloppy

\RequirePackage{setspace}
\onehalfspacing

% section size
\RequirePackage{titlesec}
\RequirePackage{color}

\titleformat{\chapter}[block]
{\fontsize{18pt}{22pt}\bfseries}
{\chaptertitlename\ \thechapter.}{0.5em}{}
\titleformat{\section}
{\fontsize{16pt}{20pt}\bfseries}{\thesection.}{1em}{}
\titleformat{\subsection}
{\fontsize{14pt}{18pt}\bfseries}{\thesubsection.}{1em}{}
\titleformat{\subsubsection}
{\fontsize{14pt}{18pt}\bfseries}{\thesubsubsection.}{1em}{}

% for graphics
\RequirePackage{graphicx}

\RequirePackage{amsmath}
\RequirePackage{listings}
\lstset{
    basicstyle=\ttfamily\footnotesize,
    backgroundcolor=\color{white},
    frame=single,
    framerule=0.5pt,
    rulecolor=\color{black},
    captionpos=t,
    tabsize=2,
    breaklines=true,
    breakatwhitespace=true,
%numbers=left,
%numberstyle=\tiny\color{gray},
%stepnumber=1,
%numbersep=10pt,
    columns=fullflexible,
    flexiblecolumns,
    keepspaces=true,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    extendedchars=true,
    breakautoindent=true,
}

\RequirePackage{longtable}

\RequirePackage{pdfpages}

\RequirePackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,
    urlcolor=blue,
}

\RequirePackage{enumitem}
\setlist{nosep}
\setlist[itemize]{
    leftmargin=0cm,
    itemindent=1.25cm,
    labelwidth=-0.6cm
}
\setlist[enumerate]{label*=\arabic*.}
\setlist[enumerate]{
    leftmargin=0cm,
    itemindent=1.25cm,
    labelwidth=-0.65cm
}
\setlist[description]{style=nextline}
\setlist[description]{
    leftmargin=0cm,
    itemindent=1.25cm,
    labelwidth=-0.65cm
}

% for headers and footers
\RequirePackage{fancyhdr}

% for non-end-to-end numbering
%\usepackage{chngcntr}
%\counterwithin{figure}{section}
%\counterwithin{table}{section}

\clubpenalty=10000
\widowpenalty=10000

\providecommand{\No}{\textnumero}

%\setlength{\abovecaptionskip}{3pt}
%\setlength{\belowcaptionskip}{3pt}

\newenvironment{image}{
    \begin{figure}[h!tp]
        \centering
        }{
    \end{figure}
}
\newcommand\includegrph[2][width=0.8\textwidth]{\includegraphics[#1]{#2}}

% new command for sections
\newcommand\Chapter[1]{
    \refstepcounter{chapter}
    \chapter*{\textbf{ГЛАВА\ \arabic{chapter}.}
    \raggedright #1
    }
    \addcontentsline{toc}{chapter}{ГЛАВА\ \arabic{chapter}.\ #1}
}
\newcommand\Section[1]{
    \refstepcounter{section}
    \section*{\textbf{\arabic{chapter}.\arabic{section}.}
    \raggedright #1
    }
    \addcontentsline{toc}{section}{\arabic{chapter}.\arabic{section}.\ #1}
}
\newcommand\Subsection[1]{
    \refstepcounter{subsection}
    \subsection*{\textbf{\arabic{chapter}.\arabic{section}.\arabic{subsection}.}
    \raggedright #1
    }
    \addcontentsline{toc}{subsection}
    {\arabic{chapter}.\arabic{section}.\arabic{subsection}.\ #1}
}
\newcommand\Subsubsection[1]{
    \refstepcounter{subsubsection}
    \subsubsection*{\textbf{\arabic{chapter}.\arabic{section}.\arabic{subsection}.\arabic{subsubsection}.}
    \raggedright #1
    }
    \addcontentsline{toc}{subsubsection}
    {\arabic{chapter}.\arabic{section}.\arabic{subsection}.\arabic{subsubsection}.\ #1}
}
\titlespacing{\chapter}{1.25cm}{0pt}{0pt}
\titlespacing{\section}{1.25cm}{0pt}{0pt}
\titlespacing{\subsection}{1.25cm}{0pt}{0pt}
\titlespacing{\subsubsection}{1.25cm}{0pt}{0pt}
\titlespacing{\paragraph}{1.25cm}{0pt}{0pt}

% new command for appendix
\newcommand\AppendixChapter[1]{
    \refstepcounter{chapter}
    \chapter*{
        \textbf{\appendixname~\thechapter.}
        \raggedright #1
    }
    \addcontentsline{toc}{chapter}{\appendixname~\thechapter.\ #1}
}
\newcommand\AppendixSection[1]{
    \refstepcounter{section}
    \section*{
        \textbf{\appendixname~\thesection.}
        \raggedright #1
    }
}
\newcommand\AppendixSubsection[1]{
    \refstepcounter{subsection}
    \section*{
        \textbf{\appendixname~\thesubsection.}
        \raggedright #1
    }
}
